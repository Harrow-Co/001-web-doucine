import{_ as D,c as l,a as e,n as v,i as p,t as c,e as b,o as i,j as E,d as k,r as S,k as j,v as A,w as N,F as _,f as M,l as V,h as Y}from"./index-DJKmMsqQ.js";const $={name:"StatCard",props:{title:{type:String,required:!0},value:{type:[String,Number],required:!0},icon:{type:String,required:!0},color:{type:String,default:"primary"},change:{type:String,default:""},changeType:{type:String,default:"neutral",validator:r=>["positive","negative","neutral"].includes(r)}},computed:{changeColorClass(){return{positive:"text-green-500",negative:"text-danger",neutral:"text-gray-500"}[this.changeType]},changeIconClass(){return{positive:"fas fa-arrow-up",negative:"fas fa-arrow-down",neutral:"fas fa-minus"}[this.changeType]}}},T={class:"bg-white rounded-lg shadow-sm p-4 flex items-center w-full card-hover"},O={class:"flex-1"},B={class:"text-sm text-gray-500 m-0"},F={class:"text-xl font-bold text-gray-700 m-0 mb-1"};function q(r,t,n,d,a,o){return i(),l("div",T,[e("div",{class:v(["bg-opacity-15 mr-3",`bg-${n.color}`])},[e("div",{class:v(["w-12 h-12 rounded-lg flex items-center justify-center text-xl",`text-${n.color}`])},[e("i",{class:v(n.icon)},null,2)],2)],2),e("div",O,[e("p",B,c(n.title),1),e("h3",F,c(n.value),1),n.change?(i(),l("p",{key:0,class:v(["text-xs flex items-center m-0",o.changeColorClass])},[e("i",{class:v(o.changeIconClass+" mr-1")},null,2),b(" "+c(n.change),1)],2)):p("",!0)])])}const I=D($,[["render",q]]),J={name:"ActionCard",props:{title:{type:String,required:!0},description:{type:String,required:!0},icon:{type:String,required:!0},color:{type:String,default:"primary"},buttonText:{type:String,default:""},buttonUrl:{type:String,default:""}},emits:["action"],methods:{navigateOrEmit(){this.buttonUrl?this.$router.push(this.buttonUrl):this.$emit("action")}}},z={class:"flex-1"},U={class:"text-lg font-semibold text-gray-700 m-0 mb-2"},L={class:"text-sm text-gray-500 m-0"};function R(r,t,n,d,a,o){return i(),l("div",{class:"card card-hover flex items-center relative overflow-hidden cursor-pointer",onClick:t[1]||(t[1]=(...m)=>o.navigateOrEmit&&o.navigateOrEmit(...m))},[e("div",{class:v(["absolute left-0 top-0 h-full w-1",`bg-${n.color}`])},null,2),e("div",{class:v(["bg-opacity-15 w-12 h-12 rounded-xl flex items-center justify-center text-xl mr-4",`bg-${n.color} text-${n.color}`])},[e("i",{class:v(n.icon)},null,2)],2),e("div",z,[e("h3",U,c(n.title),1),e("p",L,c(n.description),1),n.buttonText?(i(),l("button",{key:0,class:v(["mt-3 px-4 py-1.5 text-sm font-medium rounded-md transition-colors",`bg-${n.color} bg-opacity-10 text-${n.color} hover:bg-opacity-20`]),onClick:t[0]||(t[0]=E((...m)=>o.navigateOrEmit&&o.navigateOrEmit(...m),["stop"]))},c(n.buttonText),3)):p("",!0)]),e("div",{class:v(["text-opacity-0 transform -translate-x-2 transition-all duration-300 group-hover:text-opacity-100 group-hover:translate-x-0",`text-${n.color}`])},t[2]||(t[2]=[e("i",{class:"fas fa-arrow-right"},null,-1)]),2)])}const G=D(J,[["render",R]]),P={name:"EventCard",props:{title:{type:String,required:!0},day:{type:String,required:!0},month:{type:String,required:!0},location:{type:String,default:"-"},time:{type:String,default:"-"},showViewButton:{type:Boolean,default:!0},showEditButton:{type:Boolean,default:!0}},emits:["view","edit"]},H={class:"bg-white rounded-xl shadow-sm overflow-hidden flex card-hover"},K={class:"w-20 bg-gradient-to-b from-primary to-primary-600 text-white flex flex-col items-center justify-center py-4"},Q={class:"text-2xl font-bold leading-none"},W={class:"text-sm uppercase mt-1"},X={class:"flex-1 p-4 relative"},Z={class:"text-base font-semibold text-gray-700 m-0 mb-3 pr-16"},tt={class:"flex flex-col space-y-2"},et={class:"text-sm text-gray-500 flex items-center m-0"},rt={class:"text-sm text-gray-500 flex items-center m-0"},nt={class:"absolute top-4 right-4 flex"};function st(r,t,n,d,a,o){return i(),l("div",H,[e("div",K,[e("span",Q,c(n.day),1),e("span",W,c(n.month),1)]),e("div",X,[e("h3",Z,c(n.title),1),e("div",tt,[e("p",et,[t[2]||(t[2]=e("i",{class:"fas fa-map-marker-alt text-primary-600 mr-2 text-xs"},null,-1)),b(" "+c(n.location),1)]),e("p",rt,[t[3]||(t[3]=e("i",{class:"far fa-clock text-primary-600 mr-2 text-xs"},null,-1)),b(" "+c(n.time),1)])]),e("div",nt,[n.showViewButton?(i(),l("button",{key:0,onClick:t[0]||(t[0]=E(m=>r.$emit("view"),["stop"])),class:"w-8 h-8 rounded bg-gray-100 flex items-center justify-center text-gray-600 mr-2 hover:bg-primary hover:text-white transition-colors duration-200",title:"Voir les détails"},t[4]||(t[4]=[e("i",{class:"fas fa-eye text-sm"},null,-1)]))):p("",!0),n.showEditButton?(i(),l("button",{key:1,onClick:t[1]||(t[1]=E(m=>r.$emit("edit"),["stop"])),class:"w-8 h-8 rounded bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-primary hover:text-white transition-colors duration-200",title:"Modifier"},t[5]||(t[5]=[e("i",{class:"fas fa-edit text-sm"},null,-1)]))):p("",!0)])])])}const ot=D(P,[["render",st]]),it={name:"Dashboard",components:{StatCard:I,ActionCard:G,EventCard:ot},data(){return{eventCount:0,events:[],loading:!0,activeView:"list",sortOrder:"asc",currentDate:new Date,currentMonth:new Date().getMonth(),currentYear:new Date().getFullYear()}},computed:{sortedEvents(){return[...this.events].sort((r,t)=>{const n=this.extractDateAsNumber(r.date),d=this.extractDateAsNumber(t.date);return this.sortOrder==="asc"?n-d:d-n})},currentMonthName(){return["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"][this.currentMonth]},calendarDays(){const r=[],d=(new Date(this.currentYear,this.currentMonth,1).getDay()||7)-1,a=this.currentMonth===0?11:this.currentMonth-1,o=this.currentMonth===0?this.currentYear-1:this.currentYear,m=new Date(o,a+1,0).getDate();for(let u=0;u<d;u++){const g=m-d+u+1,w=new Date(o,a,g);r.push({date:w,dayNumber:g,currentMonth:!1,events:this.getEventsForDay(w)})}const h=new Date(this.currentYear,this.currentMonth+1,0).getDate();for(let u=1;u<=h;u++){const g=new Date(this.currentYear,this.currentMonth,u);r.push({date:g,dayNumber:u,currentMonth:!0,events:this.getEventsForDay(g)})}const y=this.currentMonth===11?0:this.currentMonth+1,s=this.currentMonth===11?this.currentYear+1:this.currentYear,x=42-r.length;for(let u=1;u<=x;u++){const g=new Date(s,y,u);r.push({date:g,dayNumber:u,currentMonth:!1,events:this.getEventsForDay(g)})}return r}},created(){this.fetchEvents()},methods:{async fetchEvents(){try{const r=await V.getAllEvents();this.eventCount=r.length,this.events=r,this.loading=!1,console.log("Données des événements:",r),r.length>0&&console.log("Structure de date exemple:",r[0].date)}catch(r){console.error("Erreur lors du chargement des événements:",r),this.loading=!1}},extractDateAsNumber(r){if(!r)return 0;try{if(r.annee&&r.mois&&r.jour){const t={janvier:1,février:2,mars:3,avril:4,mai:5,juin:6,juillet:7,août:8,septembre:9,octobre:10,novembre:11,décembre:12},n=parseInt(r.annee),d=t[r.mois.toLowerCase()]||1,a=parseInt(r.jour);return n*1e4+d*100+a}}catch(t){console.error("Erreur d'extraction de date:",t)}return 0},formatDay(r){return!r||!r.jour?"":r.jour},formatMonth(r){return!r||!r.mois?"":r.mois},isToday(r){const t=new Date;return r.getDate()===t.getDate()&&r.getMonth()===t.getMonth()&&r.getFullYear()===t.getFullYear()},getEventsForDay(r){if(!this.events||!Array.isArray(this.events)||this.events.length===0)return[];const t=r.getFullYear().toString(),n=(r.getMonth()+1).toString().padStart(2,"0"),d=r.getDate().toString().padStart(2,"0");r.getDate()===20&&r.getMonth()===1&&console.log(`Recherche d'événements pour le 20 février: ${d}-${n}-${t}`),r.getDate()===10&&r.getMonth()===2&&console.log(`Recherche d'événements pour le 10 mars: ${d}-${n}-${t}`),r.getDate()===10&&r.getMonth()===8&&console.log(`Recherche d'événements pour le 10 septembre: ${d}-${n}-${t}`);const a={janvier:"01",février:"02",mars:"03",avril:"04",mai:"05",juin:"06",juillet:"07",août:"08",septembre:"09",octobre:"10",novembre:"11",décembre:"12",fev:"02",fevrier:"02",fév:"02",mar:"03"},o={JAN:"01",FEV:"02",MAR:"03",AVR:"04",MAI:"05",JUN:"06",JUI:"07",AOU:"08",SEP:"09",OCT:"10",NOV:"11",DEC:"12"};return this.events.filter(m=>{let h=m.date;if(!h&&m.date_json)try{h=JSON.parse(m.date_json)}catch(C){return console.error(`Erreur lors du parsing de date_json pour l'événement "${m.titre}":`,C),!1}if(!h||!h.jour||!h.mois||!h.annee)return!1;const y=h.jour.toString().padStart(2,"0");let s="00";if(o[h.mois])s=o[h.mois];else{const C=h.mois.toLowerCase();s=a[C]||"00"}const f=h.annee.toString(),x=y===d,u=s===n,g=f===t,w=x&&u&&g;return(r.getDate()===20&&r.getMonth()===1||r.getDate()===10&&r.getMonth()===2||r.getDate()===10&&r.getMonth()===8)&&console.log({eventTitle:m.titre,eventDate:`${y}-${s}-${f}`,originalMonth:h.mois,calendarDate:`${d}-${n}-${t}`,dayMatches:x,monthMatches:u,yearMatches:g,isMatch:w}),w})},previousMonth(){this.currentMonth===0?(this.currentMonth=11,this.currentYear--):this.currentMonth--},nextMonth(){this.currentMonth===11?(this.currentMonth=0,this.currentYear++):this.currentMonth++},viewEvent(r){this.$router.push({name:"admin-event-details",params:{id:r}})},editEvent(r){this.$router.push({name:"admin-event-edit",params:{id:r}})},formatDate(r){return!r||!r.jour||!r.mois||!r.annee?"Date inconnue":`${r.jour} ${r.mois} ${r.annee}`}}},at={class:"admin-container w-full"},lt={class:"dashboard-welcome mb-6"},ct={class:"relative z-10 flex-1"},dt={class:"flex items-center mt-4 bg-white bg-opacity-20 rounded-lg p-4 inline-flex"},ut={class:"text-2xl font-bold text-white m-0"},mt={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8"},ht={class:"mb-8"},vt={class:"flex justify-between items-center mb-4"},gt={class:"flex space-x-2"},ft={class:"relative ml-2"},xt={key:0,class:"bg-white rounded-xl p-6 text-center"},yt={key:1,class:"bg-white rounded-xl p-6 text-center"},bt={key:2,class:"bg-white rounded-xl shadow-sm p-4"},pt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},wt={key:3,class:"flex flex-col md:flex-row gap-4"},_t={class:"calendar-container md:w-2/3"},Mt={class:"calendar-header"},Dt={class:"flex items-center"},Ct={class:"text-lg font-semibold mx-4"},kt={class:"calendar-grid"},St={class:"flex justify-center mb-2"},Et={key:0,class:"flex flex-col space-y-1"},jt=["onClick"],At={class:"bg-white rounded-xl shadow-sm p-4 md:w-1/3"},Nt={key:0,class:"text-center text-gray-500 py-4"},Vt={key:1,class:"divide-y"},Yt=["onClick"],$t={class:"flex items-center"},Tt={class:"w-10 h-10 flex-shrink-0 bg-primary rounded-full flex items-center justify-center text-white mr-3"},Ot={class:"text-sm font-semibold"},Bt={class:"text-sm font-medium m-0"},Ft={class:"text-xs text-gray-500 m-0"};function qt(r,t,n,d,a,o){const m=S("ActionCard"),h=S("router-link"),y=S("EventCard");return i(),l("div",at,[e("div",lt,[e("div",ct,[t[7]||(t[7]=e("h1",{class:"text-xl font-bold mb-2"},"Bienvenue sur votre panel",-1)),t[8]||(t[8]=e("p",{class:"text-white text-opacity-80 text-sm mb-4"},"Gérez votre association Doucine",-1)),e("div",dt,[t[6]||(t[6]=e("div",{class:"w-12 h-12 rounded-lg bg-white bg-opacity-20 flex items-center justify-center text-white mr-4"},[e("i",{class:"fas fa-calendar-alt"})],-1)),e("div",null,[t[5]||(t[5]=e("p",{class:"text-sm text-white text-opacity-90 m-0"},"Événements",-1)),e("h3",ut,c(a.eventCount),1)])])]),t[9]||(t[9]=e("div",{class:"text-5xl ml-6 text-white text-opacity-80 relative z-10 hidden md:block"},[e("i",{class:"fas fa-chart-line"})],-1)),t[10]||(t[10]=e("div",{class:"absolute top-0 right-0 w-56 h-56 bg-white bg-opacity-10 rounded-full transform translate-x-1/2 -translate-y-1/2"},null,-1))]),e("div",mt,[k(m,{title:"Créer un événement",description:"Ajoutez un nouvel événement à votre calendrier",icon:"fas fa-plus","button-text":"Créer","button-url":"/admin/events/create",color:"primary"}),k(m,{title:"Gérer les événements",description:"Consultez et modifiez vos événements",icon:"fas fa-edit","button-text":"Gérer","button-url":"/admin/events",color:"primary"})]),e("div",ht,[e("div",vt,[t[15]||(t[15]=e("h2",{class:"section-title mb-0"},"Vos événements",-1)),e("div",gt,[e("button",{onClick:t[0]||(t[0]=s=>a.activeView="list"),class:v(["px-3 py-1.5 rounded-md text-sm flex items-center",a.activeView==="list"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"])},t[11]||(t[11]=[e("i",{class:"fas fa-list mr-2"},null,-1),b(" Liste ")]),2),e("button",{onClick:t[1]||(t[1]=s=>a.activeView="calendar"),class:v(["px-3 py-1.5 rounded-md text-sm flex items-center",a.activeView==="calendar"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"])},t[12]||(t[12]=[e("i",{class:"fas fa-calendar mr-2"},null,-1),b(" Calendrier ")]),2),e("div",ft,[j(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.sortOrder=s),class:"appearance-none bg-gray-100 border-none rounded-md py-1.5 pl-3 pr-8 text-sm cursor-pointer"},t[13]||(t[13]=[e("option",{value:"asc"},"Date croissante",-1),e("option",{value:"desc"},"Date décroissante",-1)]),512),[[A,a.sortOrder]]),t[14]||(t[14]=e("div",{class:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-600"},[e("i",{class:"fas fa-chevron-down text-xs"})],-1))])])]),a.loading?(i(),l("div",xt,t[16]||(t[16]=[e("i",{class:"fas fa-spinner animate-spin text-primary text-xl"},null,-1),e("p",{class:"mt-2 text-gray-500"},"Chargement des événements...",-1)]))):a.events.length===0?(i(),l("div",yt,[t[18]||(t[18]=e("div",{class:"text-4xl text-gray-200 mb-3"},[e("i",{class:"fas fa-calendar-times"})],-1)),t[19]||(t[19]=e("p",{class:"text-gray-500 mb-4"},"Aucun événement disponible",-1)),k(h,{to:{name:"admin-event-create"},class:"btn btn-primary inline-flex"},{default:N(()=>t[17]||(t[17]=[e("i",{class:"fas fa-plus mr-2"},null,-1),b(" Créer un événement ")])),_:1,__:[17]})])):a.activeView==="list"?(i(),l("div",bt,[e("div",pt,[(i(!0),l(_,null,M(o.sortedEvents,s=>(i(),Y(y,{key:s.id,title:s.titre,day:o.formatDay(s.date),month:o.formatMonth(s.date),location:s.lieu,time:s.horaire,onView:f=>o.viewEvent(s.id),onEdit:f=>o.editEvent(s.id)},null,8,["title","day","month","location","time","onView","onEdit"]))),128))])])):a.activeView==="calendar"?(i(),l("div",wt,[e("div",_t,[e("div",Mt,[e("div",Dt,[e("button",{onClick:t[3]||(t[3]=(...s)=>o.previousMonth&&o.previousMonth(...s)),class:"p-2 hover:bg-gray-100 rounded-full"},t[20]||(t[20]=[e("i",{class:"fas fa-chevron-left"},null,-1)])),e("h3",Ct,c(o.currentMonthName)+" "+c(a.currentYear),1),e("button",{onClick:t[4]||(t[4]=(...s)=>o.nextMonth&&o.nextMonth(...s)),class:"p-2 hover:bg-gray-100 rounded-full"},t[21]||(t[21]=[e("i",{class:"fas fa-chevron-right"},null,-1)]))])]),e("div",kt,[(i(),l(_,null,M(["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],s=>e("div",{key:s,class:"calendar-day-header"},c(s),1)),64)),(i(!0),l(_,null,M(o.calendarDays,(s,f)=>(i(),l("div",{key:f,class:v(["calendar-day",{"bg-gray-50":!s.currentMonth}])},[e("div",St,[e("span",{class:v(["calendar-day-number",{"calendar-day-current":o.isToday(s.date)}])},c(s.dayNumber),3)]),s.events.length>0?(i(),l("div",Et,[(i(!0),l(_,null,M(s.events,x=>(i(),l("div",{key:x.id,class:"calendar-event",onClick:u=>o.viewEvent(x.id)},c(x.titre),9,jt))),128))])):p("",!0)],2))),128))])]),e("div",At,[t[22]||(t[22]=e("h3",{class:"text-lg font-semibold mb-4 border-b pb-2"},"Tous les événements",-1)),a.events.length===0?(i(),l("div",Nt," Aucun événement disponible ")):(i(),l("ul",Vt,[(i(!0),l(_,null,M(o.sortedEvents,s=>(i(),l("li",{key:s.id,class:"py-3 hover:bg-gray-50 rounded px-2 cursor-pointer",onClick:f=>o.viewEvent(s.id)},[e("div",$t,[e("div",Tt,[e("span",Ot,c(o.formatDay(s.date)),1)]),e("div",null,[e("h4",Bt,c(s.titre),1),e("p",Ft,c(o.formatDate(s.date)),1)])])],8,Yt))),128))]))])])):p("",!0)])])}const Jt=D(it,[["render",qt],["__scopeId","data-v-30565dee"]]);export{Jt as default};
